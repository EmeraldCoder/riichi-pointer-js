<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Riichi Mahjong Pointer</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="css/style.css" />
    <link rel="stylesheet" href="css/left-menu.css" />
    <link rel="stylesheet" href="css/delete-drop.css" />
    <link rel="stylesheet" href="css/popup.css" />
</head>
<body>
    <div id="left-menu" class="close">
        <nav>
            <a href="#" data-bind="click: reset">Reset</a>
        </nav>
        <a id="left-menu-slider"><span id="left-menu-slider-icon">></span></a>
    </div>
    
    <div id="layout">
        <div style="width: 100%;">
            <img src="img/logo.png" style="height: 40px; display: block; float: left; margin-right: 40px;" />
            <h1 style="font-size: 30px; line-height: 40px;"><span data-bind="{text: title}"></span></h1>
            <div style="clear: both;"></div>
        </div>
        
        <div id="select-tile-view" data-bind="{visible: currentView() === 'TileSelection'}">
            <div data-bind="{visible: addType() !== 'chii'}">
                <img src="img/dragongreen.png" data-bind="{click: selectTile.bind($data, 'dragon', 'green')}" />
                <img src="img/dragonred.png" data-bind="{click: selectTile.bind($data, 'dragon', 'red')}" />
                <img src="img/dragonwhite.png" data-bind="{click: selectTile.bind($data, 'dragon', 'white')}" />
            </div>
            <div data-bind="{visible: addType() !== 'chii'}">
                <img src="img/windeast.png" data-bind="{click: selectTile.bind($data, 'wind', 'east')}" />
                <img src="img/windsouth.png" data-bind="{click: selectTile.bind($data, 'wind', 'south')}" />
                <img src="img/windwest.png" data-bind="{click: selectTile.bind($data, 'wind', 'west')}" />
                <img src="img/windnorth.png" data-bind="{click: selectTile.bind($data, 'wind', 'north')}" />
            </div>
            <div>
                <img src="img/bamboo1.png" data-bind="{click: selectTile.bind($data, 'bamboo', 1)}" />
                <img src="img/bamboo2.png" data-bind="{click: selectTile.bind($data, 'bamboo', 2)}" />
                <img src="img/bamboo3.png" data-bind="{click: selectTile.bind($data, 'bamboo', 3)}" />
                <img src="img/bamboo4.png" data-bind="{click: selectTile.bind($data, 'bamboo', 4)}" />
                <img src="img/bamboo5.png" data-bind="{click: selectTile.bind($data, 'bamboo', 5)}" />
                <img src="img/bamboo6.png" data-bind="{click: selectTile.bind($data, 'bamboo', 6)}" />
                <img src="img/bamboo7.png" data-bind="{click: selectTile.bind($data, 'bamboo', 7)}" />
                <img src="img/bamboo8.png" data-bind="{click: selectTile.bind($data, 'bamboo', 8), visible: addType() !== 'chii'}" />
                <img src="img/bamboo9.png" data-bind="{click: selectTile.bind($data, 'bamboo', 9), visible: addType() !== 'chii'}" />
            </div>
            <div>
                <img src="img/character1.png" data-bind="{click: selectTile.bind($data, 'character', 1)}" />
                <img src="img/character2.png" data-bind="{click: selectTile.bind($data, 'character', 2)}" />
                <img src="img/character3.png" data-bind="{click: selectTile.bind($data, 'character', 3)}" />
                <img src="img/character4.png" data-bind="{click: selectTile.bind($data, 'character', 4)}" />
                <img src="img/character5.png" data-bind="{click: selectTile.bind($data, 'character', 5)}" />
                <img src="img/character6.png" data-bind="{click: selectTile.bind($data, 'character', 6)}" />
                <img src="img/character7.png" data-bind="{click: selectTile.bind($data, 'character', 7)}" />
                <img src="img/character8.png" data-bind="{click: selectTile.bind($data, 'character', 8), visible: addType() !== 'chii'}" />
                <img src="img/character9.png" data-bind="{click: selectTile.bind($data, 'character', 9), visible: addType() !== 'chii'}" />
            </div>
            <div>
                <img src="img/dot1.png" data-bind="{click: selectTile.bind($data, 'dot', 1)}" />
                <img src="img/dot2.png" data-bind="{click: selectTile.bind($data, 'dot', 2)}" />
                <img src="img/dot3.png" data-bind="{click: selectTile.bind($data, 'dot', 3)}" />
                <img src="img/dot4.png" data-bind="{click: selectTile.bind($data, 'dot', 4)}" />
                <img src="img/dot5.png" data-bind="{click: selectTile.bind($data, 'dot', 5)}" />
                <img src="img/dot6.png" data-bind="{click: selectTile.bind($data, 'dot', 6)}" />
                <img src="img/dot7.png" data-bind="{click: selectTile.bind($data, 'dot', 7)}" />
                <img src="img/dot8.png" data-bind="{click: selectTile.bind($data, 'dot', 8), visible: addType() !== 'chii'}" />
                <img src="img/dot9.png" data-bind="{click: selectTile.bind($data, 'dot', 9), visible: addType() !== 'chii'}" />
            </div>
        </div>

        <div data-bind="{visible: currentView() === 'Main'}">
            <div style="margin: 10px 0;">
                <fieldset>
                    <legend>Winning type</legend>
                    
                    <div style="line-height: 14px; float: left; max-width: 30%; overflow: hidden; margin-right: 5%;">
                        <span class="txt1">Winning By<br /></span>
                        <select data-bind="{value: winningType}" style="width: 100%">
                            <option value="tsumo">Tsumo</option>
                            <option value="ron">Ron</option>
                        </select>
                    </div>
                    <div style="line-height: 14px;float: left; max-width: 30%; overflow: hidden; margin-right: 5%;">
                        <span class="txt1">Complete By<br /></span>
                        <select data-bind="{value: winningSecondaryType}" style="width: 100%">
                            <option></option>
                            <option value="haitei raoyue">Haitei Raoyue</option>
                            <option value="houtei raoyui">Houtei Raoyui</option>
                            <option value="rinshan kaihou">Rinshan Kaihou</option>
                            <option value="chan kan">Chan Kan</option>
                        </select>
                    </div>
                    <div style="line-height: 14px;float: left; max-width: 30%; overflow: hidden;">
                        <span class="txt1">Riichi<br /></span>
                        <select data-bind="{value: winningRiichiType}" style="width: 100%">
                            <option></option>
                            <option value="riichi">Riichi</option>
                            <option value="riichi ippatsu">Riichi Ippatsu</option>
                            <option value="double riichi">Double Riichi</option>
                            <option value="double riichi ippatsu">Double Riichi Ippatsu</option>
                        </select>
                    </div>
                </fieldset>
            </div>
            
            <div style="margin: 10px 0;">
                <fieldset>
                    <legend>Winds</legend>
                    
                    <div style="line-height: 14px; float: left; max-width: 40%; overflow: hidden; margin-right: 5%;">
                        <span class="txt1">Prevalent: <br /></span>
                        <select data-bind="{value: prevalentWind}">
                            <option value="east">East</option>
                            <option value="south">South</option>
                            <option value="west">West</option>
                            <option value="north">North</option>
                        </select>
                    </div>
                    
                    <div style="line-height: 14px; float: left; max-width: 40%; overflow: hidden;">
                        <span class="txt1">Seat: <br /></span>
                        <select data-bind="{value: seatWind}">
                            <option value="east">East</option>
                            <option value="south">South</option>
                            <option value="west">West</option>
                            <option value="north">North</option>
                        </select>
                    </div>
                </fieldset>
            </div>
            
            <div style="margin: 10px 0;">
                <div style="float: left; width: 50%;">
                    <fieldset>
                        <legend>Dora</legend>
                        <div style="margin-bottom: 10px;">
                            <input type="button" value="+ Dora" data-bind="click: addDora.bind($data, false)" />
                        </div>
                        <div id="Dora" class="box box-dora" data-bind="template: {name: 'tile-template', foreach: doraTiles}"></div>
                    </fieldset>
                </div>
                
                <div style="float: left; width: 50%;">
                    <fieldset>
                        <legend>Ura-Dora</legend>
                        <div style="margin-bottom: 10px;">
                            <input type="button" value="+ Ura-Dora" data-bind="click: addDora.bind($data, true)" />
                        </div>
                        <div id="UraDora" class="box box-dora" data-bind="template: {name: 'tile-template', foreach: uraDoraTiles}"></div>
                    </fieldset>
                </div>
                
                <div style="clear: both;"></div>
            </div>
            
            <div style="margin: 10px 0;">
                <fieldset>
                    <legend>Concealed combinaisons</legend>
                    <div data-bind="{visible: !handIsFinish()}">
                        <input type="button" value="+ Pair" data-bind="{click: add.bind($data, true, 'pair')}" />
                        <input type="button" value="+ Pon" data-bind="{click: add.bind($data, true, 'pon')}" />
                        <input type="button" value="+ Kan" data-bind="{click: add.bind($data, true, 'kan')}" />
                        <input type="button" value="+ Chii" data-bind="{click: add.bind($data, true, 'chii')}" />
                    </div>
                    <div id="ConcealedCombinaison" class="box box-combinaison" style="margin-top: 10px;" data-bind="template: {name: 'hand-template', foreach: concealedCombinaisons}"></div>
                </fieldset>
            </div>
            
            <div style="margin: 10px 0;">
                <fieldset>
                    <legend>Open combinaisons</legend>
                    <div data-bind="{visible: !handIsFinish()}">
                        <input type="button" value="+ Pon" data-bind="{click: add.bind($data, false, 'pon')}" />
                        <input type="button" value="+ Kan" data-bind="{click: add.bind($data, false, 'kan')}" />
                        <input type="button" value="+ Chii" data-bind="{click: add.bind($data, false, 'chii')}" />
                    </div>
                    <div id="OpenCombinaison" class="box box-combinaison" style="margin-top: 10px;" data-bind="template: {name: 'hand-template', foreach: openCombinaisons}"></div>
                </fieldset>
            </div>
            
            <div>
                <input type="button" value="Calculate hand points" data-bind="{click: showPoints, visible: handIsFinish}" />
            </div>
        </div>
        
        <div data-bind="{visible: currentView() === 'Result'}">
            <div style="margin-bottom: 20px">
                <input type="button" value="back to your hand" data-bind="click: returnToMain" />
            </div>
            <div style="margin: 20px 0;">
                <p data-bind="html: pointsTotal"></p>
            
                <p><b>Han:</b> <span data-bind="html: pointsYakuTotal"></span> / <b>Fu:</b> <span data-bind="html: pointsFuTotal"></span></p>
                
                <b>Han details</b><br />
                <table>
                    <thead>
                        <tr>
                            <th>Description</th>
                            <th>Han value</th>
                        </tr>
                    </thead>
                    <tbody data-bind="foreach: pointsYakuDetails">
                        <tr>
                            <td data-bind="html: name"></td>
                            <td data-bind="html: value"></td>
                        </tr>
                    </tbody>
                </table>
                
                <br /><b>Fu details</b><br />
                <table>
                    <thead>
                        <tr>
                            <th>Description</th>
                            <th>Fu value</th>
                        </tr>
                    </thead>
                    <tbody data-bind="foreach: pointsFuDetails">
                        <tr>
                            <td data-bind="html: name"></td>
                            <td data-bind="html: value"></td>
                        </tr>
                    </tbody>
                </table>
            
            </div>
        </div>
    </div>
    
    <div id="DeleteDrop" ondragover="event.preventDefault();">
        <span id="DeleteDropMessage">Drag dora tile here to delete it!</span>
    </div>
    
    <script type="text/html" id="hand-template">
    <!-- ko foreach: tiles -->
        <!-- ko if: $index() === $parent.tiles.length-1 && !isWinningTile() -->
        <span class="last" data-bind="click: $root.setWinningTile, attr: {'data-combinaison-index': $parent._index, 'data-combinaison-concealed': $parent._isConcealed}"><img data-bind="attr: {src: 'img/' + suit + value + '.png'}" /></span>
        <!-- /ko -->
        
        <!-- ko if: $index() === $parent.tiles.length-1 && isWinningTile() -->
        <span class="waiting last" data-bind="click: $root.setWinningTile, attr: {'data-combinaison-index': $parent._index, 'data-combinaison-concealed': $parent._isConcealed}"><img data-bind="attr: {src: 'img/' + suit + value + '.png'}" /></span>
        <!-- /ko -->
        
        <!-- ko if: $index() !== $parent.tiles.length-1 && isWinningTile() -->
        <span class="waiting" data-bind="click: $root.setWinningTile, attr: {'data-combinaison-index': $parent._index, 'data-combinaison-concealed': $parent._isConcealed}"><img data-bind="attr: {src: 'img/' + suit + value + '.png'}" /></span>
        <!-- /ko -->
        
        <!-- ko if: $index() !== $parent.tiles.length-1 && !isWinningTile() -->
        <span data-bind="click: $root.setWinningTile, attr: {'data-combinaison-index': $parent._index, 'data-combinaison-concealed': $parent._isConcealed}"><img data-bind="attr: {src: 'img/' + suit + value + '.png'}" /></span>
        <!-- /ko -->
    <!-- /ko -->
    </script>
    
    <script type="text/html" id="tile-template">
        <span data-bind="attr: {'data-index': $index}"><img data-bind="attr: {src: 'img/' + suit + value + '.png'}" /></span>
    </script>

    <script src="vendor/jquery.js"></script>
    <script src="src/core/tile-classes.js"></script>
    <script src="src/core/combinaison-classes.js"></script>
    <script src="src/core/hand-classes.js"></script>
    <script src="src/core/yakupattern-classes.js"></script>
    <script src="src/core/pointer-classes.js"></script>
    <script src="src/gui/RiichiMahjongPointerViewModel.js"></script>
    <script src="src/gui/LeftMenu.js"></script>
    <script src="src/gui/Popup.js"></script>
    <script src="src/gui/TouchDoraDeletion.js"></script>
    <script src="src/gui/TouchCombinaisonDeletion.js"></script>
    <script src="src/gui/DragDropDoraDeletion.js"></script>
    <script src="src/gui/DragDropCombinaisonDeletion.js"></script>   
</body>
</html>
